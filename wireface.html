<html>
  <head>
    <title>Three.js - Polygon Offset Test</title>
    <style>
      body { margin:0; }
      canvas { width:100%; height:100%; }
    </style>
  </head>
  <body>
    <script src="js/three.min.js"></script>
    <script>

var windowHalfWidth  = window.innerWidth  / 2;
var windowHalfHeight = window.innerHeight / 2;

var mouseX = 0;
var mouseY = 0;

var clock, renderer, scene, camera;

document.addEventListener('mousemove', onDocumentMouseMove, false);

init();
animate();

function init()
{
    clock = new THREE.Clock();

    renderer = new THREE.WebGLRenderer();
    renderer.setSize(window.innerWidth, window.innerHeight);
    renderer.setClearColor(0xffffff);

    scene = new THREE.Scene();
    camera = new THREE.PerspectiveCamera(30, window.innerWidth / window.innerHeight, 0.1, 50);

    var material = new THREE.MeshBasicMaterial({color:0xf0f0f0, polygonOffset:true, polygonOffsetFactor:1.0, polygonOffsetUnits:1.0});
    var geometry = new THREE.BoxGeometry(1, 1, 1, 1);
    scene.add(new THREE.Mesh(geometry, material));

    geometry = new THREE.Geometry();
    geometry.vertices.push(
        new THREE.Vector3(-1, -1, -1),
        new THREE.Vector3(+1, -1, -1),
        new THREE.Vector3(+1, +1, -1),
        new THREE.Vector3(-1, +1, -1),
        new THREE.Vector3(-1, -1, -1),

        new THREE.Vector3(-1, -1, +1),
        new THREE.Vector3(+1, -1, +1),
        new THREE.Vector3(+1, +1, +1),
        new THREE.Vector3(-1, +1, +1),
        new THREE.Vector3(-1, -1, +1),

        new THREE.Vector3(-1, +1, +1),
        new THREE.Vector3(-1, +1, -1),

        new THREE.Vector3(+1, +1, -1),
        new THREE.Vector3(+1, +1, +1),

        new THREE.Vector3(+1, -1, +1),
        new THREE.Vector3(+1, -1, -1)
    );

    material = new THREE.LineBasicMaterial({color:0});
    var line = new THREE.Line(geometry, material);
    line.scale.set(0.5, 0.5, 0.5);
    scene.add(line);

    window.addEventListener('resize', onWindowResize, false);
    document.body.appendChild(renderer.domElement);
}

function onWindowResize()
{
    windowHalfWidth  = window.innerWidth  / 2;
    windowHalfHeight = window.innerHeight / 2;

    camera.aspect = window.innerWidth / window.innerHeight;
    camera.updateProjectionMatrix();

    renderer.setSize(window.innerWidth, window.innerHeight);
}

function onDocumentMouseMove(event)
{
    mouseX = (event.clientX / window.innerWidth ) * 2 - 1;
    mouseY = (event.clientY / window.innerHeight) * 2 - 1;
}

function animate()
{
    requestAnimationFrame(animate);
    render();
}

function render()
{
    var time = clock.getElapsedTime();

    camera.position.set(0, 0, 10 + Math.sin(time * 0.3) * 5.0);
    camera.position.applyEuler(new THREE.Euler(Math.sin(time * 0.184) * 0.2 - 0.4, time * 0.4, 0, "ZYX"));
    camera.lookAt(scene.position);

    renderer.render(scene, camera);
}

    </script>
  </body>
</html>
